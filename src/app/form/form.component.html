<div class="container-fluid">
  <div class="row mt-2">
    <div class="col">
      <div class="card shadow">
        <div class="card-body">
          <div class="row">
            <div
              class="col text-center border-bottom border-info padding-bottom"
            >
              <span class="h4">User Form</span>
            </div>
          </div>
          <div class="row mt-3">
            <div class="col-md-10 offset-md-1 col-lg-8 offset-lg-2">
              <form
                [formGroup]="userForm"
                (submit)="handleFormSubmit(form.value)"
                #form="ngForm"
              >
                <div class="row">
                  <div class="col-md-6">
                    <div class="form-group">
                      <label>Name:</label>
                      <input
                        type="text"
                        class="form-control"
                        formControlName="name"
                      />
                      <div
                        *ngIf="
                          nameField.invalid &&
                          (nameField.dirty || nameField.touched)
                        "
                      >
                        <span
                          class="small text-danger"
                          *ngIf="nameField.hasError('required')"
                          >Name is required</span
                        >
                        <span
                          class="small text-danger"
                          *ngIf="nameField.hasError('pattern')"
                          >Name is required Characters only</span
                        >
                        <span
                          class="small text-danger"
                          *ngIf="
                            nameField.hasError('minlength') &&
                            !nameField.hasError('pattern')
                          "
                          >Name is required minimum 2 Characters</span
                        >
                      </div>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="form-group">
                      <label>Email:</label>
                      <input
                        type="text"
                        class="form-control"
                        formControlName="email"
                      />
                      <div
                        *ngIf="
                          emailField.invalid &&
                          (emailField.dirty || emailField.touched)
                        "
                      >
                        <span
                          class="small text-danger"
                          *ngIf="emailField.hasError('required')"
                          >Email is required</span
                        >
                        <span
                          class="small text-danger"
                          *ngIf="emailField.hasError('email')"
                          >Email is not valid</span
                        >
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row">
                  <div class="col-md-6">
                    <div class="form-group">
                      <label>Gender:</label><br />
                      <div class="form-check form-check-inline">
                        <input
                          class="form-check-input"
                          type="radio"
                          id="male"
                          value="Male"
                          formControlName="gender"
                        />
                        <label class="form-check-label" for="male">Male</label>
                      </div>
                      <div class="form-check form-check-inline">
                        <input
                          class="form-check-input"
                          type="radio"
                          id="female"
                          value="Female"
                          formControlName="gender"
                        />
                        <label class="form-check-label" for="female"
                          >Female</label
                        >
                      </div>
                      <div
                        *ngIf="
                          genderField.invalid &&
                          (genderField.dirty || genderField.touched)
                        "
                      >
                        <span
                          class="small text-danger"
                          *ngIf="genderField.hasError('required')"
                          >Gender is required</span
                        >
                      </div>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="form-group">
                      <label>City:</label>
                      <select class="form-control" formControlName="city">
                        <option value="">Select</option>
                        <option value="Pune">Pune</option>
                        <option value="Nagpur">Nagpur</option>
                        <option value="Mumbai">Mumbai</option>
                        <option value="Goa">Goa</option>
                        <option value="Amravati">Amravati</option>
                      </select>
                      <div
                        *ngIf="
                          cityField.invalid &&
                          (cityField.dirty || cityField.touched)
                        "
                      >
                        <span
                          class="small text-danger"
                          *ngIf="cityField.hasError('required')"
                          >City is required</span
                        >
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row">
                  <div class="col-md-6">
                    <div class="form-group">
                      <label>Course:</label><br />
                      <div
                        formArrayName="courses"
                        class="form-check form-check-inline"
                        *ngFor="
                          let course of userForm.get('courses').controls;
                          let i = index
                        "
                      >
                        <input
                          class="form-check-input"
                          type="checkbox"
                          id="course{{ i }}"
                          [formControlName]="i"
                        />
                        <label class="form-check-label" for="course{{ i }}">{{
                          courses[i]
                        }}</label>
                      </div>
                      <div
                        *ngIf="
                          coursesField.invalid &&
                          (coursesField.dirty || coursesField.touched)
                        "
                      >
                        <span
                          class="small text-danger"
                          *ngIf="coursesField.hasError('required')"
                          >Courses is required</span
                        >
                      </div>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="form-group">
                      <label>File:</label>
                      <input
                        type="file"
                        class="form-control-file"
                        formControlName="file"
                        (change)="handleFile($event)"
                        accept="image/*"
                      />
                      <div
                        *ngIf="
                          fileField.invalid &&
                          (fileField.dirty || fileField.touched)
                        "
                      >
                        <span
                          class="small text-danger"
                          *ngIf="fileField.hasError('required')"
                          >File is required</span
                        >
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row mt-2">
                  <div class="col-md-4 offset-md-4">
                    <div class="form-group">
                      <button
                        class="btn btn-success btn-block"
                        type="submit"
                        [disabled]="userForm.invalid"
                      >
                        Submit
                      </button>
                    </div>
                  </div>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="row mt-3">
    <div class="col">
      <div class="card shadow">
        <div class="card-body">
          <div class="row">
            <div class="col">
              <h2 class="text-center">All Records</h2>
            </div>
          </div>
          <div class="row" *ngIf="formData.length === 0; else data">
            <div class=" col">
              <div class="alert alert-danger">
                No records found.
              </div>
            </div>
          </div>
          <ng-template #data>
            <div class="row">
              <div class="col">
                <p class="small text-danger">
                  Note: Double click To delete row
                </p>
              </div>
              <div class="col text-right">
                <button
                  class="btn btn-outline-primary btn-sm"
                  (click)="changeView()"
                >
                  Change View
                </button>
              </div>
            </div>
            <ng-template [ngIf]="defaultView">
              <div
                class="row shadow-sm border mt-3 text-md-center"
                *ngFor="let record of formData; let i = index; let isOdd = odd"
                [ngClass]="{ 'bg-light': isOdd }"
                (dblclick)="handleDelete(i)"
                [@flyInOut]="'in'"
              >
                <div class="col-md-2 align-self-center pt-2 pt-md-0">
                  {{ record.name }}
                </div>
                <div class="col-md-3 align-self-center">
                  {{ record.email }}
                </div>
                <div class="col-md-1 align-self-center">
                  {{ record.gender }}
                </div>
                <div class="col-md-2 align-self-center">
                  {{ record.city }}
                </div>
                <div class="col-md-2 align-self-center">
                  {{ record.courses.join(", ") }}
                </div>
                <div class="col-md-2">
                  <img [src]="record.file" class="img-fluid" />
                </div>
              </div>
            </ng-template>
            <ng-template [ngIf]="!defaultView">
              <div class="row">
                <div
                  class="col-md-4 col-xl-3 mt-2"
                  *ngFor="let record of formData; let i = index"
                  (dblclick)="handleDelete(i)"
                  [@flyInOut]="'in'"
                >
                  <div class="card shadow-sm">
                    <img class="card-img-top" [src]="record.file" />
                    <div class="card-body">
                      <p><strong>Name: </strong>{{ record.name }}</p>
                      <p><strong>Email: </strong>{{ record.email }}</p>
                      <p><strong>Gender: </strong>{{ record.gender }}</p>
                      <p><strong>City: </strong>{{ record.city }}</p>
                      <p>
                        <strong>Courses: </strong
                        >{{ record.courses.join(", ") }}
                      </p>
                    </div>
                  </div>
                </div>
              </div>
            </ng-template>
          </ng-template>
        </div>
      </div>
    </div>
  </div>
</div>
